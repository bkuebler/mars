#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
# export DH_VERBOSE=1

NAME=marslight
DEB_NAME=$(NAME)-dkms
VERSION=$(shell dpkg-parsechangelog | grep ^Version: | cut -d ' ' -f 2)

%:
	dh $@ --with dkms

override_dh_install:
	dh_install kernel usr/src/$(NAME)-$(VERSION)/
	dh_install scripts usr/src/$(NAME)-$(VERSION)/
	find "debian/${DEB_NAME}/usr/src/$(NAME)-$(VERSION)" -type f -exec chmod 644 {} \;
	find "debian/${DEB_NAME}/usr/src/$(NAME)-$(VERSION)/scripts" -type f -exec chmod 755 {} \;

override_dh_dkms:
	dh_dkms -V $(VERSION)

override_dh_auto_build:
override_dh_auto_install:

